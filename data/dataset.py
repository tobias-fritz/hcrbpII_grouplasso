# The source of this data is:
# Wenjing Wang et al. Science338,1340-1343 (2012). DOI:10.1126/science.1226135

# The data for the mutants
wt_seq = "TRDQNGTWEMESNENFEGYMKALDIDFATRKIAVRLTQTKVIDQDGDNFKTKTTSTFRNYDVDFTVGVEFDEYTKSLDNRHVKALVTWEGDVLVCVQKGEKENRGWKQWIEGDKLYLELTCGDQVCRQVFKKK"
mutant_dict = { 
# mutant : lambda_max (nm)
":":576, # WT
# Mutants from
"Q108K:K40L":508, #4ruu
"Q108K:K40L:R58R":508,
"Q108K:K40L:T53W":491,
"Q108K:K40L:T53D":494,
"Q108K:K40L:T53M":498,
"Q108K:K40L:T53N":500,
"Q108K:K40L:T53V":503,
"Q108K:K40L:T53S":508,
"Q108K:K40L:T53C":513, #5fen
#S3
"Q108K:K40L:L77E":504, 
"Q108K:K40L:R58E":500, 
"Q108K:K40L:T29E":496, 
"Q108K:K40L:F16Y":486,
#S4
"Q108K:K40L:R58D":500,
"Q108K:K40L:R58E":500,
"Q108K:K40L:R58L":500,
"Q108K:K40L:R58A":499,
"Q108K:K40L:R58Q":499,
"Q108K:K40L:R58W":527,
"Q108K:K40L:R58F":524,
"Q108K:K40L:R58Y":535,
#S5
"Q108K:K40L:R58W":527,
"Q108K:K40L:T51V:R58W":570,
"Q108K:K40L:T53C:R58W":540,
"Q108K:K40L:T51V:T53C:R58W":585,
"Q108K:K40L:T51V:Y19W:R58W":577,
"Q108K:K40L:T51V:T53C:Y19W:T29L:Q4W:R58W":613,
"Q108K:K40L:R58Y":535,
"Q108K:K40L:T51V:R58Y":563,
"Q108K:K40L:T53C:R58Y":540,                  
"Q108K:K40L:T51V:T53C:R58Y":576,           
"Q108K:K40L:T51V:Y19W:R58Y":565,          
"Q108K:K40L:T51V:T53C:Y19W:T29L:Q4W:R58Y":593,
#S6
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L":591,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4F":613,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4W":613,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4L":613,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4A":613,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4N":612,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4T":610,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4K":616,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4R":622, # 4eej
#S7
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4F:A33H":614,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4F:A33L":605,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4F:A33E":615,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4F:A33F":616,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4F:A33Y":620,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4F:A33W":636,
"Q108K:K40L:T51V:T53C:Y19W:R58F:T29L:Q4F:A33W":616,
"Q108K:K40L:T51V:T53C:Y19W:R58Y:T29L:Q4F:A33W":600,
"Q108K:K40L:T51V:T53C:Y19W:R58L:T29L:Q4F:A33W":583,
"Q108K:K40L:T51V:T53C:Y19W:R58H:T29L:Q4F:A33W":573,
"Q108K:K40L:T51V:T53C:Y19W:R58E:T29L:Q4F:A33W":586,
"Q108K:K40L:T51V:T53C:Y19W:R58A:T29L:Q4F:A33W":550,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:Q4R:A33W":644,
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L:A33W":606, # 4ede
"Q108K:T51D:L117E":425, #M1
"Q108K:T51D":474, #M2
"Q108K:K40S":483, #M3
"Q108K:K40L:T51V":533, #M5
"Q108K:K40L:T51V:T53C":539, 
"Q108K:K40L:Y19W":513,
"Q108K:K40L:T51V:Y19W":537,
"Q108K:K40L:T51V:T53C:Y19W":538, 
"Q108K:K40L:T51V:Y19W:R58W":577, #M7
"Q108K:K40L:T51V:T53C:Y19W:R58W:T29L":591, #!M8
"Q108K:K40L:T51V:T53C:V19W:R58W:T29L:Q4W":613, #M9
"Q108K:K40L:T51V:R58W:Y19W:R58W:T29L:Q4R":622, #M10
"Q108K:K40L:T51V.:T53C:Y19W:R58W:T29L:Q4R:A33W":644, #M11
# Maria M6 mutants
"Q108K:K40L:T51V:R58W:E72Q:Q38E":514,
"Q108K:K40L:T51V:R58W:E72Q:Q38E:S55D":525,
"Q108K:K40L:T51V:R58W:Q128K:Q97E":521,
}

#generate seq from mutant string
def get_seq(init_seq, mutant_str):

    mutations = mutant_str.split(":")
    seq = list(init_seq)
    try:
        for mut in mutations:
            pos = int(mut[1:-1])
            aa = mut[-1]
            seq[pos-1] = aa
    except ValueError:
        pass
    return "".join(seq)

# generate sequences from mutant_dict
dataset = {get_seq(wt_seq, mutant):lambda_max for mutant, lambda_max in mutant_dict.items()}

# write the data to json file
import json
path = "hcrbpII.json"

out_dict = {"wt_seq":wt_seq, "mutants":mutant_dict}

with open(path, "w") as f:
    json.dump(out_dict, f)